<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Mood Flashcards</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="mood-pink">
    <div class="bubbles">
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
    </div>

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-10">
                <div class="main-card card p-4 mt-5">
                    <div class="text-center mb-4">
                        <h1>MoOd cArDs</h1>
                        <p class="text-muted">Mood? BET</p>
                    </div>

                    {% if error %}
                    <div class="alert alert-danger">
                        {{ error }}
                    </div>
                    {% endif %}

                    <form action="/generate" method="POST">
                        <div class="mb-4">
                            <label class="form-label fw-bold">How are you feeling?</label>
                            <div class="row text-center">
                                <div class="col-md-4 mb-3">
                                    <input type="radio" class="btn-check" name="mood" id="relax" value="relax" checked>
                                    <label class="btn btn-outline-mood w-100" for="relax">
                                        <img src="{{ url_for('static', filename='images/relax-cat.png') }}" class="mood-image" alt="Relax Cat">
                                        <div class="mood-name">Relaxed?</div>
                                        <small class="text-muted">Lets Rock it</small>
                                    </label>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <input type="radio" class="btn-check" name="mood" id="panic" value="panic">
                                    <label class="btn btn-outline-mood w-100" for="panic">
                                        <img src="{{ url_for('static', filename='images/panic-cat.png') }}" class="mood-image" alt="Panic Cat">
                                        <div class="mood-name">Panicking?</div>
                                        <small class="text-muted">Sucks but lets do it</small>
                                    </label>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <input type="radio" class="btn-check" name="mood" id="tired" value="tired">
                                    <label class="btn btn-outline-mood w-100" for="tired">
                                        <img src="{{ url_for('static', filename='images/tired-cat.png') }}" class="mood-image" alt="Tired Cat">
                                        <div class="mood-name">Tired?</div>
                                        <small class="text-muted">easyy there you can do it</small>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label for="paragraph" class="form-label fw-bold">Enter your study text (max 400 words):</label>
                            <textarea class="form-control" id="paragraph" name="paragraph" rows="6" 
                                      placeholder="Paste your textbook content, notes, or any study material here..." required></textarea>
                            <div class="form-text">Word count: <span id="wordCount">0</span>/400</div>
                        </div>

                        <div class="text-center d-flex justify-content-center gap-3 flex-wrap">
                            <button type="submit" class="btn btn-primary btn-lg px-5" id="createBtn">
                                Create My Flashcards
                            </button>
                            <button type="button" class="btn btn-primary btn-lg px-5" id="musicToggleBtn">
                                ðŸŽµ Play Focus Music
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    
    <div class="bunny-container">
        <div class="speech-bubble" id="speechBubble">
            Ready to create some flashcards? ðŸ“š
        </div>
        <div class="grass"></div>
        <div class="bunny">
            <div class="bunny__ears">
                <div class="bunny__ear bunny__ear--left"></div>
                <div class="bunny__ear bunny__ear--right"></div>
            </div>
            <div class="bunny__feet">
                <div class="bunny__foot bunny__foot--left"></div>
                <div class="bunny__foot bunny__foot--right"></div>
            </div>
            <div class="bunny__tail"></div>
            <div class="bunny__paw"></div>
            <div class="bunny__body">
                <div class="bunny__eyes"></div>
                <div class="bunny__nose"></div>
                <div class="bunny__cheeks"></div>
                <div class="bunny__mouth"></div>
            </div>
        </div>
    </div>

    
    <iframe 
        id="youtubePlayer"
        style="position: fixed; bottom: -9999px; left: -9999px; width: 1px; height: 1px;"
        frameborder="0" 
        allow="autoplay; encrypted-media">
    </iframe>

    <script>
        
        const youtubePlayer = document.getElementById('youtubePlayer');
        const musicBtn = document.getElementById('musicToggleBtn');
        const MUSIC_URL = 'https://www.youtube.com/embed/WPni755-Krg?autoplay=1&loop=1&playlist=WPni755-Krg&controls=0&enablejsapi=1';

        
        let musicPlaying = sessionStorage.getItem('musicPlaying') === 'true';
        
        if (musicPlaying) {
            youtubePlayer.src = MUSIC_URL;
            musicBtn.innerHTML = 'â¸ï¸ Stop Music';
            musicBtn.style.animation = 'music-pulse 2s ease-in-out infinite';
        }

        musicBtn.addEventListener('click', function(e) {
            e.preventDefault(); 
            
            if (musicPlaying) {
                // Stop music by removing src
                youtubePlayer.src = '';
                musicBtn.innerHTML = 'ðŸŽµ Play Focus Music';
                musicBtn.style.animation = 'none';
                musicPlaying = false;
                sessionStorage.setItem('musicPlaying', 'false');
                console.log('Music stopped');
            } else {
                // Play music by setting src
                youtubePlayer.src = MUSIC_URL;
                musicBtn.innerHTML = 'â¸ï¸ Stop Music';
                musicBtn.style.animation = 'music-pulse 2s ease-in-out infinite';
                musicPlaying = true;
                sessionStorage.setItem('musicPlaying', 'true');
                console.log('Music playing');
            }
        });
        

        
        const homepageMessages = [
            "Ready to create some flashcards? ðŸ“š",
            "Choose your study mood! ðŸŽ¯",
            "Paste your text below! âœ¨",
            "Let's make learning fun! ðŸŒŸ",
            "You've got this! ðŸ’ª"
        ];
        
        const speechBubble = document.getElementById('speechBubble');
        const bunny = document.querySelector('.bunny');
        let currentMessageIndex = 0;

        bunny.addEventListener('click', function() {
            currentMessageIndex = (currentMessageIndex + 1) % homepageMessages.length;
            speechBubble.textContent = homepageMessages[currentMessageIndex];
            speechBubble.classList.add('bubble-pop');
            setTimeout(() => {
                speechBubble.classList.remove('bubble-pop');
            }, 300);
        });

       
        setInterval(() => {
            currentMessageIndex = (currentMessageIndex + 1) % homepageMessages.length;
            speechBubble.textContent = homepageMessages[currentMessageIndex];
            speechBubble.classList.add('bubble-pop');
            setTimeout(() => {
                speechBubble.classList.remove('bubble-pop');
            }, 300);
        }, 8000);

       
        const textarea = document.getElementById('paragraph');
        const wordCount = document.getElementById('wordCount');
        
        textarea.addEventListener('input', function() {
            const words = this.value.trim().split(/\s+/);
            const count = this.value.trim() === '' ? 0 : words.length;
            wordCount.textContent = count;
            
            if (count > 400) {
                wordCount.style.color = 'red';
                this.style.borderColor = 'red';
            } else {
                wordCount.style.color = 'black';
                this.style.borderColor = '#dee2e6';
            }
        });

        
        document.querySelectorAll('.mood-image').forEach(img => {
            img.onerror = function() {
                this.style.display = 'none';
                const emoji = document.createElement('div');
                emoji.className = 'mood-emoji';
                emoji.textContent = this.alt.includes('Relax') ? 'ðŸ˜Œ' : 
                                  this.alt.includes('Panic') ? 'ðŸ˜°' : 'ðŸ˜´';
                this.parentNode.insertBefore(emoji, this.nextSibling);
            };
        });
    </script>
</body>
</html>