<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ mood_name }} - Your Flashcards</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Balsamiq+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="mood-{{ color }}">
    <div class="bubbles">
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
    </div>

    
    <div style="position: fixed; top: 20px; right: 20px; z-index: 1002;">
        <button type="button" class="btn btn-primary btn-lg" id="musicToggleBtn" style="padding: 12px 25px;">
            üéµ Play Focus Music
        </button>
    </div>

    <div class="container">
        <div class="text-center mb-4">
            <h1 class="text-white">{{ mood_name }} Flashcards üí´</h1>
            <p class="text-white">Click cards to flip them and reveal answers!</p>
        </div>

        {% for card in flashcards %}
        <div class="row justify-content-center mb-4">
            <div class="col-md-10">
                <div class="flashcard-container">
                    <div class="flashcard" onclick="flipCard(this)">
                        
                        <div class="flashcard-front">
                            <div class="card-number">Card {{ loop.index }}/5</div>
                            <h3>Question</h3>
                            <p class="flashcard-text">{{ card.question }}</p>
                            <small class="text-muted">Click to flip and see answer</small>
                        </div>
                        
                        
                        <div class="flashcard-back">
                            <div class="card-number">Card {{ loop.index }}/5</div>
                            <h3>Answer</h3>
                            <p class="flashcard-text">{{ card.answer }}</p>
                            <div class="motivation-message">
                                {{ messages[loop.index0] }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}

        <div class="text-center mt-4">
            <a href="/" class="btn btn-light btn-lg">‚Üê Create New Flashcards</a>
        </div>
    </div>

    
    <div class="bunny-container">
        <div class="speech-bubble" id="speechBubble">
            {{ messages[0] }}
        </div>
        <div class="grass"></div>
        <div class="bunny">
            <div class="bunny__ears">
                <div class="bunny__ear bunny__ear--left"></div>
                <div class="bunny__ear bunny__ear--right"></div>
            </div>
            <div class="bunny__feet">
                <div class="bunny__foot bunny__foot--left"></div>
                <div class="bunny__foot bunny__foot--right"></div>
            </div>
            <div class="bunny__tail"></div>
            <div class="bunny__paw"></div>
            <div class="bunny__body">
                <div class="bunny__eyes"></div>
                <div class="bunny__nose"></div>
                <div class="bunny__cheeks"></div>
                <div class="bunny__mouth"></div>
            </div>
        </div>
    </div>

    
    <iframe 
        id="youtubePlayer"
        style="position: fixed; bottom: -9999px; left: -9999px; width: 1px; height: 1px;"
        frameborder="0" 
        allow="autoplay; encrypted-media">
    </iframe>

    <script>
       
        function flipCard(card) {
            card.classList.toggle('flipped');
        }

        
        const youtubePlayer = document.getElementById('youtubePlayer');
        const musicBtn = document.getElementById('musicToggleBtn');
        const MUSIC_URL = 'https://www.youtube.com/embed/WPni755-Krg?autoplay=1&loop=1&playlist=WPni755-Krg&controls=0&enablejsapi=1';

        // Check if music was playing before (using sessionStorage)
        let musicPlaying = sessionStorage.getItem('musicPlaying') === 'true';
        
        if (musicPlaying) {
            youtubePlayer.src = MUSIC_URL;
            musicBtn.innerHTML = '‚è∏Ô∏è Stop Music';
            musicBtn.style.animation = 'music-pulse 2s ease-in-out infinite';
        }

        musicBtn.addEventListener('click', function(e) {
            e.preventDefault();
            
            if (musicPlaying) {
                // Stop music
                youtubePlayer.src = '';
                musicBtn.innerHTML = 'üéµ Play Focus Music';
                musicBtn.style.animation = 'none';
                musicPlaying = false;
                sessionStorage.setItem('musicPlaying', 'false');
                console.log('Music stopped');
            } else {
                // Play music
                youtubePlayer.src = MUSIC_URL;
                musicBtn.innerHTML = '‚è∏Ô∏è Stop Music';
                musicBtn.style.animation = 'music-pulse 2s ease-in-out infinite';
                musicPlaying = true;
                sessionStorage.setItem('musicPlaying', 'true');
                console.log('Music playing');
            }
        });

        // Bunny yahan pe intreact krega
        const speechBubble = document.getElementById("speechBubble");
        const bunny = document.querySelector('.bunny');
        
        
        const messages = [
            "You're doing great! Take your time üíï",
            "Learning at your own pace is perfect üå∏", 
            "Every answer is progress! üíñ",
            "You've got this, no rush! ‚ú®",
            "Breathe and believe in yourself üå∫"
        ];
        
        let currentMessageIndex = 0;

        // message badlne yahan pe
        bunny.addEventListener('click', function() {
            currentMessageIndex = (currentMessageIndex + 1) % messages.length;
            speechBubble.textContent = messages[currentMessageIndex];
            speechBubble.classList.add("bubble-pop");
            setTimeout(() => {
                speechBubble.classList.remove('bubble-pop');
            }, 300);
        });

        
        setInterval(() => {
            currentMessageIndex = (currentMessageIndex + 1) % messages.length;
            speechBubble.textContent = messages[currentMessageIndex];
            speechBubble.classList.add("bubble-pop");
            setTimeout(() => {
                speechBubble.classList.remove('bubble-pop');
            }, 300);
        }, 10000);

        
        document.querySelectorAll('.flashcard').forEach(card => {
            card.addEventListener('click', function() {
                // Small chance to change message when flipping cards
                if (Math.random() < 0.3) {
                    currentMessageIndex = (currentMessageIndex + 1) % messages.length;
                    speechBubble.textContent = messages[currentMessageIndex];
                    speechBubble.classList.add("bubble-pop");
                    setTimeout(() => {
                        speechBubble.classList.remove('bubble-pop');
                    }, 300);
                }
            });
        });
    </script>
</body>
</html>